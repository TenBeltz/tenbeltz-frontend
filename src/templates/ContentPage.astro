---
import Layout from '@/layouts/Layout.astro';
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import Divider from '@/components/Divider.astro';
import LeadMagnetForm from '@/components/LeadMagnetForm';
import { getLangFromUrl, useTranslations } from '@/i18n/utils';

const { id } = Astro.params;
const canonicalUrl = id ? `https://tenbeltz.com/contenido/${id}` : 'https://tenbeltz.com/contenido';
const url = new URL(Astro.request.url);
const token = url.searchParams.get('token');

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<Layout
  title={t('content.page.title')}
  description={t('content.page.description')}
  canonical={canonicalUrl}
>
  <Header />
  <main class="relative z-10 flex flex-col flex-1 overflow-x-hidden">
    <section class="relative text-white">
      <div class="flex flex-col items-center justify-center px-4 py-20 mx-auto text-center max-w-screen-2xl gap-y-4 lg:px-16 lg:py-24">
        <span class="text-xs font-semibold tracking-[0.4em] text-pheromone-purple/70">{t('content.tag')}</span>
        <h1 class="text-4xl font-extrabold lg:text-5xl">{t('content.h1')}</h1>
        <p class="max-w-2xl text-lg text-slate-300">
          {t('content.intro')}
        </p>
      </div>
    </section>

    <Divider text={t('content.divider')} />

    <section class="relative text-white bg-grid">
      <div class="max-w-screen-xl px-4 py-20 mx-auto lg:px-16 lg:py-24">
        <LeadMagnetForm client:load magnetId={id || ''} downloadToken={token || undefined} lang={lang} />
      </div>
    </section>
  </main>
  <Footer />
</Layout>
